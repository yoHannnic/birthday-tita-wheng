/* --- PRANK LOGIC (30 JUMPS EDITION) --- */
let jumpCount = 0;
const MAX_JUMPS = 30;

function initPrank() {
    const btn = document.getElementById('prank-gate-btn');
    const container = document.getElementById('scr-gate');
    const instructionText = container.querySelector('p');

    const jump = (e) => {
        if (jumpCount >= MAX_JUMPS) return; // Stop jumping after 30

        // Prevent clicking on mobile while jumping
        if (e.type === 'touchstart') e.preventDefault();

        // Switch to absolute positioning if not already
        if (btn.style.position !== 'absolute') {
            btn.style.position = 'absolute';
            btn.style.width = '200px';
            btn.style.zIndex = '1000';
        }

        // Calculate boundaries
        const maxX = container.clientWidth - 200;
        const maxY = container.clientHeight - 50;

        // Move to random spot
        btn.style.left = Math.max(0, Math.min(maxX, Math.random() * maxX)) + 'px';
        btn.style.top = Math.max(0, Math.min(maxY, Math.random() * maxY)) + 'px';

        jumpCount++;
        playSound('pop');

        // Funny messages based on progress
        if (jumpCount === 5) instructionText.innerHTML = "Wait, let me move! üèÉ‚Äç‚ôÄÔ∏è";
        if (jumpCount === 10) instructionText.innerHTML = "Bilis naman ni Tita! üí®";
        if (jumpCount === 20) {
            instructionText.innerHTML = "Hingal na ako... konti na lang! ü•µ";
            btn.style.filter = "hue-rotate(90deg)"; // Change color to show it's "tired"
        }
        if (jumpCount === 28) instructionText.innerHTML = "Okay, okay... last one! üõë";

        // After 30 hits, reset to clickable
        if (jumpCount === MAX_JUMPS) {
            btn.style.position = 'relative';
            btn.style.left = '0';
            btn.style.top = '0';
            btn.style.width = '100%';
            btn.style.filter = "none";
            instructionText.innerHTML = "Sige na nga, click me na! ‚ú®";
            instructionText.style.color = "#4cd137";
        }
    };

    // Listeners for both Mobile and Desktop
    btn.addEventListener('touchstart', jump);
    btn.addEventListener('mouseenter', jump);
}
